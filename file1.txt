Added some code here to change the logic.
Added some additional code for issue fix.